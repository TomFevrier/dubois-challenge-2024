import{s as ae,a as ue,n as I,o as fe,t as ce}from"../chunks/scheduler.CEIrVncP.js";import{S as se,i as oe,e as T,z as E,c as N,a as w,A as S,d as g,b as v,f as b,m as y,g as me,B as he,s as q,o as J,E as pe,l as z,t as $,h as k,p as K,v as P,w as x,x as L,y as B,j as de,k as ge,D as ve,r as O}from"../chunks/index.sbiNFhB7.js";import{m as _e,c as Q,L as $e,C as we,d as ke,N as be,g as ye}from"../chunks/utils.k10X1Xwd.js";import{p as Ee,m as Se,g as Me,j as Ce}from"../chunks/index.qv7dz3oY.js";var j=Math.abs,A=Math.cos,D=Math.sin,d=1e-6,F=Math.PI,G=F/2,U=Pe(2),M=180/F,C=F/180;function X(n){return n>1?G:n<-1?-G:Math.asin(n)}function Pe(n){return n>0?Math.sqrt(n):0}function xe(n,e){var r=n*D(e),t=30,l;do e-=l=(e+D(e)-r)/(1+A(e));while(j(l)>d&&--t>0);return e/2}function Le(n,e,r){function t(l,s){return[n*l*A(s=xe(r,s)),e*D(s)]}return t.invert=function(l,s){return s=X(s/e),[l/(n*A(s)),X((2*s+D(2*s))/r)]},t}var Be=Le(U/G,U,F);function Ie(n,e){return j(n[0]-e[0])<d&&j(n[1]-e[1])<d}function Y(n,e){for(var r=-1,t=n.length,l=n[0],s,u,a,i=[];++r<t;){s=n[r],u=(s[0]-l[0])/e,a=(s[1]-l[1])/e;for(var m=0;m<e;++m)i.push([l[0]+m*u,l[1]+m*a]);l=s}return i.push(s),i}function qe(n){var e=[],r,t,l,s,u,a,i,m=n[0].length;for(i=0;i<m;++i)r=n[0][i],t=r[0][0],l=r[0][1],s=r[1][1],u=r[2][0],a=r[2][1],e.push(Y([[t+d,l+d],[t+d,s-d],[u-d,s-d],[u-d,a+d]],30));for(i=n[1].length-1;i>=0;--i)r=n[1][i],t=r[0][0],l=r[0][1],s=r[1][1],u=r[2][0],a=r[2][1],e.push(Y([[u-d,a-d],[u-d,s+d],[t+d,s+d],[t+d,l-d]],30));return{type:"Polygon",coordinates:[Se(e)]}}function ze(n,e,r){var t,l;function s(i,m){for(var o=m<0?-1:1,f=e[+(m<0)],c=0,p=f.length-1;c<p&&i>f[c][2][0];++c);var h=n(i-f[c][1][0],m);return h[0]+=n(f[c][1][0],o*m>o*f[c][0][1]?f[c][0][1]:m)[0],h}r?s.invert=r(s):n.invert&&(s.invert=function(i,m){for(var o=l[+(m<0)],f=e[+(m<0)],c=0,p=o.length;c<p;++c){var h=o[c];if(h[0][0]<=i&&i<h[1][0]&&h[0][1]<=m&&m<h[1][1]){var _=n.invert(i-n(f[c][1][0],0)[0],m);return _[0]+=f[c][1][0],Ie(s(_[0],_[1]),[i,m])?_:null}}});var u=Ee(s),a=u.stream;return u.stream=function(i){var m=u.rotate(),o=a(i),f=(u.rotate([0,0]),a(i));return u.rotate(m),o.sphere=function(){_e(t,f)},o},u.lobes=function(i){return arguments.length?(t=qe(i),e=i.map(function(m){return m.map(function(o){return[[o[0][0]*C,o[0][1]*C],[o[1][0]*C,o[1][1]*C],[o[2][0]*C,o[2][1]*C]]})}),l=e.map(function(m){return m.map(function(o){var f=n(o[0][0],o[0][1])[0],c=n(o[2][0],o[2][1])[0],p=n(o[1][0],o[0][1])[1],h=n(o[1][0],o[1][1])[1],_;return p>h&&(_=p,p=h,h=_),[[f,p],[c,h]]})}),u):e.map(function(m){return m.map(function(o){return[[o[0][0]*M,o[0][1]*M],[o[1][0]*M,o[1][1]*M],[o[2][0]*M,o[2][1]*M]]})})},e!=null&&u.lobes(e),u}var De=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function Fe(){return ze(Be,De).scale(169.529).rotate([20,0])}function He(n){return n}function Te(n){if(n==null)return He;var e,r,t=n.scale[0],l=n.scale[1],s=n.translate[0],u=n.translate[1];return function(a,i){i||(e=r=0);var m=2,o=a.length,f=new Array(o);for(f[0]=(e+=a[0])*t+s,f[1]=(r+=a[1])*l+u;m<o;)f[m]=a[m],++m;return f}}function Ne(n,e){for(var r,t=n.length,l=t-e;l<--t;)r=n[l],n[l++]=n[t],n[t]=r}function je(n,e){return typeof e=="string"&&(e=n.objects[e]),e.type==="GeometryCollection"?{type:"FeatureCollection",features:e.geometries.map(function(r){return Z(n,r)})}:Z(n,e)}function Z(n,e){var r=e.id,t=e.bbox,l=e.properties==null?{}:e.properties,s=Ae(n,e);return r==null&&t==null?{type:"Feature",properties:l,geometry:s}:t==null?{type:"Feature",id:r,properties:l,geometry:s}:{type:"Feature",id:r,bbox:t,properties:l,geometry:s}}function Ae(n,e){var r=Te(n.transform),t=n.arcs;function l(o,f){f.length&&f.pop();for(var c=t[o<0?~o:o],p=0,h=c.length;p<h;++p)f.push(r(c[p],p));o<0&&Ne(f,h)}function s(o){return r(o)}function u(o){for(var f=[],c=0,p=o.length;c<p;++c)l(o[c],f);return f.length<2&&f.push(f[0]),f}function a(o){for(var f=u(o);f.length<4;)f.push(f[0]);return f}function i(o){return o.map(a)}function m(o){var f=o.type,c;switch(f){case"GeometryCollection":return{type:f,geometries:o.geometries.map(m)};case"Point":c=s(o.coordinates);break;case"MultiPoint":c=o.coordinates.map(s);break;case"LineString":c=u(o.arcs);break;case"MultiLineString":c=o.arcs.map(u);break;case"Polygon":c=i(o.arcs);break;case"MultiPolygon":c=o.arcs.map(i);break;default:return null}return{type:f,coordinates:c}}return m(e)}function ee(n,e,r){const t=n.slice();return t[6]=e[r],t}function te(n){let e;return{c(){e=E("path"),this.h()},l(r){e=S(r,"path",{class:!0,d:!0}),w(e).forEach(g),this.h()},h(){v(e,"class","country svelte-58xd0g"),v(e,"d",n[2](n[6]))},m(r,t){b(r,e,t)},p:I,d(r){r&&g(e)}}}function Ge(n){let e,r,t,l,s,u,a,i,m,o=Q(n[1].features),f=[];for(let c=0;c<o.length;c+=1)f[c]=te(ee(n,o,c));return{c(){e=T("div"),r=T("div"),t=E("svg"),l=E("defs"),s=E("mask"),u=E("path"),a=E("g");for(let c=0;c<f.length;c+=1)f[c].c();i=E("path"),this.h()},l(c){e=N(c,"DIV",{class:!0});var p=w(e);r=N(p,"DIV",{class:!0});var h=w(r);t=S(h,"svg",{width:!0,viewBox:!0});var _=w(t);l=S(_,"defs",{});var W=w(l);s=S(W,"mask",{id:!0});var R=w(s);u=S(R,"path",{d:!0,fill:!0}),w(u).forEach(g),R.forEach(g),W.forEach(g),a=S(_,"g",{class:!0,mask:!0});var V=w(a);for(let H=0;H<f.length;H+=1)f[H].l(V);V.forEach(g),i=S(_,"path",{class:!0,d:!0}),w(i).forEach(g),_.forEach(g),h.forEach(g),p.forEach(g),this.h()},h(){v(u,"d",n[2]({type:"Sphere"})),v(u,"fill","white"),v(s,"id","mask"),v(a,"class","countries"),v(a,"mask","url(#mask)"),v(i,"class","outline svelte-58xd0g"),v(i,"d",n[2]({type:"Sphere"})),v(t,"width","100%"),v(t,"viewBox","0 0 "+ie+" "+le),v(r,"class","wrapper"),v(e,"class","map svelte-58xd0g"),ue(()=>n[4].call(e))},m(c,p){b(c,e,p),y(e,r),y(r,t),y(t,l),y(l,s),y(s,u),y(t,a);for(let h=0;h<f.length;h+=1)f[h]&&f[h].m(a,null);y(t,i),m=me(e,n[4].bind(e))},p(c,[p]){if(p&6){o=Q(c[1].features);let h;for(h=0;h<o.length;h+=1){const _=ee(c,o,h);f[h]?f[h].p(_,p):(f[h]=te(_),f[h].c(),f[h].m(a,null))}for(;h<f.length;h+=1)f[h].d(1);f.length=o.length}},i:I,o:I,d(c){c&&g(e),he(f,c),m()}}}const ie=2e3,le=1080;function We(n,e,r){let{world:t}=e;const l=je(t,t.objects.world),s=Fe().fitSize([ie,le],l),u=Me().projection(s);let a;function i(){a=this.clientWidth,r(0,a)}return n.$$set=m=>{"world"in m&&r(3,t=m.world)},[a,l,u,t,i]}class Re extends se{constructor(e){super(),oe(this,e,We,Ge,ae,{world:3})}}function re(n){let e,r;return e=new $e({}),{c(){P(e.$$.fragment)},l(t){x(e.$$.fragment,t)},m(t,l){L(e,t,l),r=!0},i(t){r||($(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){B(e,t)}}}function ne(n){let e,r,t,l,s,u;return e=new we({props:{$$slots:{default:[Ve]},$$scope:{ctx:n}}}),t=new Re({props:{world:n[1]}}),s=new ke({props:{$$slots:{week:[Ke],default:[Je]},$$scope:{ctx:n}}}),{c(){P(e.$$.fragment),r=q(),P(t.$$.fragment),l=q(),P(s.$$.fragment)},l(a){x(e.$$.fragment,a),r=z(a),x(t.$$.fragment,a),l=z(a),x(s.$$.fragment,a)},m(a,i){L(e,a,i),b(a,r,i),L(t,a,i),b(a,l,i),L(s,a,i),u=!0},p(a,i){const m={};i&4&&(m.$$scope={dirty:i,ctx:a}),e.$set(m);const o={};i&2&&(o.world=a[1]),t.$set(o);const f={};i&4&&(f.$$scope={dirty:i,ctx:a}),s.$set(f)},i(a){u||($(e.$$.fragment,a),$(t.$$.fragment,a),$(s.$$.fragment,a),u=!0)},o(a){k(e.$$.fragment,a),k(t.$$.fragment,a),k(s.$$.fragment,a),u=!1},d(a){a&&(g(r),g(l)),B(e,a),B(t,a),B(s,a)}}}function Ve(n){let e;return{c(){e=de("Lorem ipsum")},l(r){e=ge(r,"Lorem ipsum")},m(r,t){b(r,e,t)},d(r){r&&g(e)}}}function Je(n){let e,r;return e=new be({props:{prev:"/challenge03"}}),{c(){P(e.$$.fragment)},l(t){x(e.$$.fragment,t)},m(t,l){L(e,t,l),r=!0},p:I,i(t){r||($(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){B(e,t)}}}function Ke(n){let e,r="Semaine 4";return{c(){e=T("a"),e.textContent=r,this.h()},l(t){e=N(t,"A",{href:!0,target:!0,slot:!0,"data-svelte-h":!0}),ve(e)!=="svelte-1aa9gsk"&&(e.textContent=r),this.h()},h(){v(e,"href","https://raw.githubusercontent.com/ajstarks/dubois-data-portraits/master/challenge/2024/challenge04/original-plate-01.jpg"),v(e,"target","_blank"),v(e,"slot","week")},m(t,l){b(t,e,l)},p:I,d(t){t&&g(e)}}}function Oe(n){let e,r,t,l,s=!n[0]&&re(),u=n[1]&&ne(n);return{c(){e=q(),s&&s.c(),r=q(),u&&u.c(),t=J(),this.h()},l(a){pe("svelte-g4s6k5",document.head).forEach(g),e=z(a),s&&s.l(a),r=z(a),u&&u.l(a),t=J(),this.h()},h(){document.title="Du Bois Challenge 2024 | Semaine 4"},m(a,i){b(a,e,i),s&&s.m(a,i),b(a,r,i),u&&u.m(a,i),b(a,t,i),l=!0},p(a,[i]){a[0]?s&&(O(),k(s,1,1,()=>{s=null}),K()):s?i&1&&$(s,1):(s=re(),s.c(),$(s,1),s.m(r.parentNode,r)),a[1]?u?(u.p(a,i),i&2&&$(u,1)):(u=ne(a),u.c(),$(u,1),u.m(t.parentNode,t)):u&&(O(),k(u,1,1,()=>{u=null}),K())},i(a){l||($(s),$(u),l=!0)},o(a){k(s),k(u),l=!1},d(a){a&&(g(e),g(r),g(t)),s&&s.d(a),u&&u.d(a)}}}function Qe(n,e,r){let t=!1,l;return fe(async()=>{r(1,l=await Ce("data/challenge04/world.json")),await ce(),ye(),setTimeout(()=>r(0,t=!0),500)}),[t,l]}class et extends se{constructor(e){super(),oe(this,e,Qe,Oe,ae,{})}}export{et as component};
